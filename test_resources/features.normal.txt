
-- Running minitest on 1 namespace
---- Testing minitest-features-test

With a ':=' expectation...
... success
âœ… (inc 1) := 2
... failure
âŒ (inc 0) := 2
[1m   Actual: [0m1
... error
ğŸ”¥ (throw (ex-info "intentionally-raised" {})) := 1
ExceptionInfo intentionally-raised {}


With a ':?' expectation...
... success
âœ… (zero? (inc -1)) ?
... failure
âŒ (zero? (inc 0)) ?
[1m   Actual: [0mfalse
... error
ğŸ”¥ (throw (ex-info "intentionally-raised" {})) ?
ExceptionInfo intentionally-raised {}


This is an effect


*1, *2, *3 should be bound
[1m[Effect] [0m (inc 0) -> 1
âœ… (inc *1) := 2
âœ… (inc *2) := 2
âœ… (inc *3) := 2
âœ… (inc *1) := 3


*e should be set in effects
[1mğŸ˜± [Effect] [0m (throw (ex-info intentionally raised in effect {})) -> nil
ExceptionInfo intentionally raised in effect {}
âœ… (ex-message *e) := "intentionally raised in effect"


*e should be set in tests
ğŸ”¥ (throw (ex-info "intentionally raised in assertion" {})) := 0
ExceptionInfo intentionally raised in assertion {}
âœ… (ex-message *e) := "intentionally raised in assertion"


wildcards are supported...
... for successes
âœ… [1 2] := [1 _]
... for failures
âŒ [2 2] := [1 _]
[1m   Actual: [0m[2 2]
... for errors
ğŸ”¥ [1 (throw (ex-info "intentionally raised" {}))] := [1 _]
ExceptionInfo intentionally raised {}


wildcards are supported...
... for maps (success)
âœ… {:a 1, :b 2} := {:a 1, :b _}
... for maps (failure)
âŒ {:a 1, :b 2} := {:a 2, :b _}
[1m   Actual: [0m{:a 1, :b 2}
... for maps (errors)
ğŸ”¥ {:a 1, :b (throw (ex-info "intentionally-raised" {}))} := {:a 1, :b _}
ExceptionInfo intentionally-raised {}


wildcards are not supported...
... as keys in maps
ğŸ”¥ {:a 1} := {_ 1}
ExceptionInfo [Minitest] Can't use wildcards as keys in maps {:type :minitest/illegal-wildcard, :tested {:a 1}, :expected {_ 1}}
... as elements of sets
ğŸ”¥ #{1 2} := #{_ 2}
ExceptionInfo [Minitest] Can't use wildcards in sets {:type :minitest/illegal-wildcard, :tested #{1 2}, :expected #{_ 2}}


inner tests ...
... inline
âœ… 1 := 1
... macroexpansion
âœ… 2 := 2
... function call
âœ… 3 := 3
... inner inner test
âœ… 4 := 4
... in a let form
âœ… (inc 1) := 2
... are reported coherently with surrounding effect output
-- before
âœ… 0 := 0
-- after
... play well with report levels
âœ… 100 := 100


config via case meta for...
... :? expectation
ğŸ‘ (true? true) ?
... := expectation
ğŸ‘ [2] := [2]
...effect
ğŸ‘ (do :nothing) -> :nothing


behavior with dynamic vars...


... when not bound
âœ… *dyn-var* := :root-val


... when bound
...... outside tests blocks
âœ… *dyn-var* := :bound-val


...... inside tests blocks
âœ… *dyn-var* := :bound-val



behavior with config


... outside tests blocks
ğŸ‘ 1 := 1


... inside tests blocks
ğŸ‘ 2 := 2



behavior with context


... outside tests blocks
âœŒï¸ 1 := 1


... inside tests blocks
âœŒï¸ 2 := 2


Unification with (unified? _ _) ...
... success
âœ… [0 1 2 2] :unified? [0 ?a ?b ?b]
... failure
âŒ [-1 1 2 3 4] :unified? [0 _ ?b ?b]
{:expected {:form [0 _ ?b ?b]}, :tested {:form [-1 1 2 3 4]}}
[1m   Unification conflicts:[0m
     â€¢ ?b: 3
       ?b: 2
[1m   Inequalities:[0m
     â€¢ [1;31m[[0m[31m--1[0m [32m+0[0m _ ?b ?b [31m-4[0m[1;31m][0m
... error
ğŸ”¥ [(throw (ex-info "intentionally-raised" {}))] :unified? [_]
ExceptionInfo intentionally-raised {}



   27 successes, 5 failures, 8 errors.
